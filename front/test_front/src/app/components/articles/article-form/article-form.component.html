<div class="article-form-container">
  <form [formGroup]="articleForm" (ngSubmit)="onSubmit()" class="article-form">
    <div class="form-header">
      <h2>{{ isEditMode ? "Edit Article" : "Create New Article" }}</h2>
    </div>

    @if (errorMessage) {
      <div class="alert alert-danger">
        {{ errorMessage }}
      </div>
    }

    @if (successMessage) {
      <div class="alert alert-success">
        {{ successMessage }}
      </div>
    }

    <div class="form-group">
      <label for="title">Title *</label>
      <input
        type="text"
        id="title"
        formControlName="title"
        class="form-control"
        [ngClass]="{ 'is-invalid': title?.touched && title?.errors }"
        placeholder="Enter article title"
      />
      @if (title?.touched && title?.errors) {
        <div class="invalid-feedback">
          @if (title?.errors?.['required']) {
            <div>Title is required</div>
          }
          @if (title?.errors?.['minlength']) {
            <div>Title must be at least 5 characters</div>
          }
        </div>
      }
    </div>

    <div class="form-group">
      <label for="content">Content *</label>
      <textarea
        id="content"
        formControlName="content"
        rows="10"
        class="form-control"
        [ngClass]="{ 'is-invalid': content?.touched && content?.errors }"
        placeholder="Write your article content here..."
      ></textarea>
      @if (content?.touched && content?.errors) {
        <div class="invalid-feedback">
          @if (content?.errors?.['required']) {
            <div>Content is required</div>
          }
          @if (content?.errors?.['minlength']) {
            <div>Content must be at least 50 characters</div>
          }
        </div>
      }
    </div>

    <div class="form-group">
      <label for="tags">Tags</label>
      <input
        type="text"
        id="tags"
        formControlName="tags"
        class="form-control"
        placeholder="tag1, tag2, tag3"
        (blur)="onTagsBlur($event)"
      />
      <small class="form-text text-muted">
        Separate tags with commas
      </small>
    </div>

    <div class="form-group">
      <label for="image">Featured Image</label>
      
      @if (imagePreview || existingImageUrl) {
        <div class="mb-3">
          <img 
            [src]="imagePreview || existingImageUrl" 
            alt="Article preview" 
            class="img-thumbnail article-image-preview"
          >
          <button 
            type="button" 
            class="btn btn-sm btn-outline-danger ml-2"
            (click)="removeImage()"
          >
            Remove Image
          </button>
        </div>
      }
      
      <div class="custom-file">
        <input
          type="file"
          id="image"
          (change)="onFileSelected($event)"
          accept="image/*"
          class="custom-file-input"
        />
        <label class="custom-file-label" for="image">
          {{ selectedFile ? selectedFile.name : 'Choose image file' }}
        </label>
      </div>
      <small class="form-text text-muted">
        Recommended size: 1200x630 pixels (JPEG or PNG)
      </small>
    </div>

    <div class="form-actions mt-4">
      <button
        type="submit"
        class="btn btn-primary btn-lg"
        [disabled]="articleForm.invalid || isLoading"
      >
        @if (isLoading) {
          <span class="spinner-border spinner-border-sm mr-2"></span>
        }
        {{ isEditMode ? "Update Article" : "Publish Article" }}
      </button>
     
    </div>
  </form>
</div>